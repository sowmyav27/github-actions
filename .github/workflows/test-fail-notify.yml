name: Notify on Failure

on:
  workflow_dispatch:  # Allows for manual triggering of the workflow

jobs:
  test:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout the repository
        uses: actions/checkout@v2

      - name: Run a sample test (replace with your actual test command)
        id: test-failure
        run: |
          echo "Running test..."
          exit 1  # Simulate a failure for testing purposes
      
      - name: Collect Test Results
        id: collect-results
        run: |
          if [[ "${{ steps.execute-e2e-tests.outcome }}" == "failure" ]]; then
            echo "status=failure" >> $GITHUB_ENV
          else
            echo "status=success" >> $GITHUB_ENV
          fi

      - name: Notify Slack on Nightly Run Status
        uses: sowmyav27/github-actions/.github/actions/action.yaml@main
        if: always() 
        with:
          test_results: ${{ env.test_results }}
          run_id: ${{ github.run_id }}
          run_number: ${{ github.run_number }}
          status: ${{ env.status }}
          source_repo: ${{ github.repository }}
          webhook_url: ${{ secrets.SLACK_WEBHOOK_URL_CI_TESTS_ALERTS }}
     
